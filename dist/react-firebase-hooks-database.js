!function(e,r){"use strict";var n=function(){return(n=Object.assign||function(e){for(var r,n=1,t=arguments.length;n<t;n++)for(var u in r=arguments[n])Object.prototype.hasOwnProperty.call(r,u)&&(e[u]=r[u]);return e}).apply(this,arguments)};function t(){for(var e=0,r=0,n=arguments.length;r<n;r++)e+=arguments[r].length;var t=Array(e),u=0;for(r=0;r<n;r++)for(var o=arguments[r],a=0,i=o.length;a<i;a++,u++)t[u]=o[a];return t}var u=function(e,r){var t;if(e.exists){var u=e.val();return function(e){return null!=e&&"object"==typeof e&&!1===Array.isArray(e)}(u)?n(n({},u),r?((t={})[r]=e.key,t):null):u}},o={loading:!0,value:{keys:[],values:[]}},a=function(e,r){switch(r.type){case"add":return r.snapshot?n(n({},e),{error:void 0,value:i(e.value,r.snapshot,r.previousKey)}):e;case"change":return r.snapshot?n(n({},e),{error:void 0,value:s(e.value,r.snapshot)}):e;case"error":return n(n({},e),{error:r.error,loading:!1,value:{keys:void 0,values:void 0}});case"move":return r.snapshot?n(n({},e),{error:void 0,value:l(e.value,r.snapshot,r.previousKey)}):e;case"remove":return r.snapshot?n(n({},e),{error:void 0,value:c(e.value,r.snapshot)}):e;case"reset":return o;case"value":return n(n({},e),{error:void 0,loading:!1});case"empty":return n(n({},e),{loading:!1,value:{keys:void 0,values:void 0}});default:return e}},i=function(e,r,n){if(!r.key)return e;var u=e.keys,o=e.values;if(!n)return{keys:u?t([r.key],u):[r.key],values:o?t([r],o):[r]};var a=u?u.indexOf(n):0;return{keys:u?t(u.slice(0,a+1),[r.key],u.slice(a+1)):[r.key],values:o?t(o.slice(0,a+1),[r],o.slice(a+1)):[r]}},s=function(e,r){if(!r.key)return e;var u=e.keys,o=e.values,a=u?u.indexOf(r.key):0;return n(n({},e),{values:o?t(o.slice(0,a),[r],o.slice(a+1)):[r]})},c=function(e,r){if(!r.key)return e;var n=e.keys,u=e.values,o=n?n.indexOf(r.key):0;return{keys:n?t(n.slice(0,o),n.slice(o+1)):[],values:u?t(u.slice(0,o),u.slice(o+1)):[]}},l=function(e,r,n){var t=c(e,r);return i(t,r,n)},v=function(e){return{loading:void 0===e||null===e,value:e}},f=function(e){var t=e?e():void 0,u=r.useReducer(function(e,r){switch(r.type){case"error":return n(n({},e),{error:r.error,loading:!1,value:void 0});case"reset":return v(r.defaultValue);case"value":return n(n({},e),{error:void 0,loading:!1,value:r.value});default:return e}},v(t)),o=u[0],a=u[1];return{error:o.error,loading:o.loading,reset:function(){var r=e?e():void 0;a({type:"reset",defaultValue:r})},setError:function(e){a({type:"error",error:e})},setValue:function(e){a({type:"value",value:e})},value:o.value}},d=function(e,r){var n=!e&&!r,t=!!e&&!!r&&e.isEqual(r);return n||t},y=function(e,n){return function(e,n,t){var u=r.useRef(e);return r.useEffect(function(){n(e,u.current)||(u.current=e,t&&t())}),u}(e,d,n)},p=function(e){var n=r.useReducer(a,o),t=n[0],u=n[1],i=y(e,function(){return u({type:"reset"})}),s=function(e,r){u({type:"add",previousKey:r,snapshot:e})},c=function(e){u({type:"change",snapshot:e})},l=function(e,r){u({type:"move",previousKey:r,snapshot:e})},v=function(e){u({type:"remove",snapshot:e})},f=function(e){u({type:"error",error:e})},d=function(){u({type:"value"})};return r.useEffect(function(){var e=i.current;if(e)return e.once("value",d,f),e.on("child_added",s,f),e.on("child_changed",c,f),e.on("child_moved",l,f),e.on("child_removed",v,f),function(){e.off("child_added",s),e.off("child_changed",c),e.off("child_moved",l),e.off("child_removed",v)};u({type:"empty"})},[i.current]),[t.value.values,t.loading,t.error]},h=function(e){var n=f(),t=n.error,u=n.loading,o=n.reset,a=n.setError,i=n.setValue,s=n.value,c=y(e,o);return r.useEffect(function(){var e=c.current;if(e)return e.on("value",i,a),function(){e.off("value",i)};i(void 0)},[c.current]),[s,u,t]};e.useList=p,e.useListKeys=function(e){var r=p(e),n=r[0],t=r[1],u=r[2];return[n?n.map(function(e){return e.key}):void 0,t,u]},e.useListVals=function(e,n){var t=p(e),o=t[0],a=t[1],i=t[2];return[r.useMemo(function(){return o?o.map(function(e){return u(e,n?n.keyField:void 0)}):void 0},[o,n&&n.keyField]),a,i]},e.useObject=h,e.useObjectVal=function(e,n){var t=h(e),o=t[0],a=t[1],i=t[2];return[r.useMemo(function(){return o?u(o,n?n.keyField:void 0):void 0},[o,n&&n.keyField]),a,i]}}(this["react-firebase-hooks"]=this["react-firebase-hooks"]||{},react);
//# sourceMappingURL=react-firebase-hooks-database.js.map
